<div class="pdf-viewer-container h-full flex flex-col">
  <!-- Hidden file input for click to upload -->
  <input #fileInput type="file" accept=".pdf" (change)="onFileSelected($event)" style="display: none;">

  <!-- Upload Section -->
  <div class="upload-section flex-1 flex items-center justify-center"
       *ngIf="!pdfSrc"
       (dragover)="onDragOver($event)"
       (dragleave)="onDragLeave($event)"
       (drop)="onDrop($event)">
    <div class="upload-area text-center p-12 border-2 border-dashed rounded-2xl transition-all duration-300 cursor-pointer"
         (click)="triggerFileInput()"
         (dragover)="onDragOver($event)"
         (dragleave)="onDragLeave($event)"
         (drop)="onDrop($event)">
      <div class="upload-icon-container mb-6">
        <div class="w-20 h-20 bg-gradient-accent rounded-2xl flex items-center justify-center mx-auto shadow-lg">
          <mat-icon class="text-4xl text-white" style="display:inline-flex;align-items:center;justify-content:center;line-height:1;">picture_as_pdf</mat-icon>
        </div>
      </div>
      <h3 class="text-xl font-semibold text-white mb-3">No PDF Document Loaded</h3>
      <p class="text-white/80 mb-4">Drag and drop your PDF here or click to upload</p>
      <div class="upload-instructions text-sm text-white/60 mt-4">
        <div class="flex items-center justify-center gap-2 mb-2">
          <mat-icon class="text-base">mouse</mat-icon>
          <span>Click to browse files</span>
        </div>
        <div class="flex items-center justify-center gap-2">
          <mat-icon class="text-base">touch_app</mat-icon>
          <span>Or drag & drop PDF files here</span>
        </div>
      </div>
    </div>
  </div>

  <!-- PDF Content -->
  <div class="pdf-content h-full flex flex-col" *ngIf="pdfSrc">
    <!-- PDF Controls Toolbar -->
    <div class="pdf-controls bg-gray-50 border-b border-gray-200 p-3 flex items-center justify-between flex-shrink-0">
      <!-- Navigation Controls -->
      <div class="control-group flex items-center space-x-2">
        <button mat-icon-button
                class="toolbar-btn"
                (click)="previousPage()"
                [disabled]="currentPage <= 1"
                matTooltip="Previous page">
          <mat-icon>chevron_left</mat-icon>
        </button>

        <div class="flex items-center space-x-2">
          <input
            type="number"
            [(ngModel)]="currentPage"
            min="1"
            [max]="totalPages"
            class="page-input w-16 text-center px-2 py-1 rounded text-sm">
          <span class="text-sm text-white/80">/ {{ totalPages }}</span>
        </div>

        <button mat-icon-button
                class="toolbar-btn"
                (click)="nextPage()"
                [disabled]="currentPage >= totalPages"
                matTooltip="Next page">
          <mat-icon>chevron_right</mat-icon>
        </button>
      </div>

      <!-- Zoom Controls -->
      <div class="control-group flex items-center space-x-2">
        <button mat-icon-button
                class="toolbar-btn"
                (click)="zoomOut()"
                matTooltip="Zoom out">
          <mat-icon>zoom_out</mat-icon>
        </button>
        <span class="text-sm text-white/80 min-w-12 text-center">{{ (zoom * 100) | number:'1.0-0' }}%</span>
        <button mat-icon-button
                class="toolbar-btn"
                (click)="zoomIn()"
                matTooltip="Zoom in">
          <mat-icon>zoom_in</mat-icon>
        </button>
      </div>

      <!-- Document Info -->
      <div class="control-group flex items-center space-x-2">
        <div class="document-info text-sm text-gray-600">
          <mat-icon class="text-lg mr-1">description</mat-icon>
          <span>PDF Document</span>
        </div>
      </div>
    </div>

    <!-- Error Display -->
    <div class="error-message bg-red-50 border border-red-200 rounded-lg p-4 m-4 flex items-center space-x-2" *ngIf="error">
      <mat-icon class="text-red-500">error</mat-icon>
      <span class="text-red-700">{{ error }}</span>
    </div>

    <!-- Backend Processing State -->
    <div class="loading-container flex-1 flex flex-col items-center justify-center" *ngIf="isProcessing">
      <div class="loading-content text-center">
        <div class="loading-spinner-custom mb-6">
          <div class="spinner-ring processing"></div>
          <div class="spinner-ring processing"></div>
          <div class="spinner-ring processing"></div>
        </div>
        <h3 class="text-lg font-semibold text-white mb-2">Processing PDF Document</h3>
        <p class="text-white/80 mb-4">Analyzing and extracting content from your document...</p>
        <div class="processing-steps">
          <div class="step">üìÑ Parsing PDF structure</div>
          <div class="step">üîç Extracting text content</div>
          <div class="step">üß† Creating searchable index</div>
        </div>
      </div>
    </div>

    <!-- PDF Viewer -->
    <div class="pdf-display flex-1 overflow-auto"
         *ngIf="pdfSrc && !error && !isLoading && !isProcessing">
      <pdf-viewer
        #pdfViewer
        [src]="pdfSrc"
        [render-text]="true"
        [original-size]="false"
        [page]="currentPage"
        [zoom]="zoom"
        [show-all]="true"
        [fit-to-page]="false"
        (after-load-complete)="onPdfLoaded($event)"
        (page-rendered)="onPageRendered($event)"
        (error)="onPdfError($event)"
        class="w-full h-full">
      </pdf-viewer>
    </div>
  </div>
</div>