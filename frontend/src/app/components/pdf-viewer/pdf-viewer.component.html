<div class="pdf-viewer-container h-full flex flex-col">
  <!-- Hidden file input - always present -->
  <input
    type="file"
    accept=".pdf"
    (change)="onFileSelected($event)"
    #fileInput
    style="display: none"
  />

  <!-- Compact Toolbar -->
  <div class="pdf-toolbar" *ngIf="isLoaded">
    <div class="toolbar-content">
      <!-- Navigation Controls -->
      <div class="nav-controls">
        <button class="toolbar-btn" (click)="previousPage()" [disabled]="page <= 1">
          <mat-icon>chevron_left</mat-icon>
        </button>
        <span class="page-info">{{ page }} / {{ totalPages }}</span>
        <button class="toolbar-btn" (click)="nextPage()" [disabled]="page >= totalPages">
          <mat-icon>chevron_right</mat-icon>
        </button>
      </div>

      <!-- Zoom Controls -->
      <div class="zoom-controls">
        <button class="toolbar-btn" (click)="zoomOut()" [disabled]="zoom <= 0.5">
          <mat-icon>zoom_out</mat-icon>
        </button>
        <span class="zoom-info">{{ (zoom * 100) | number:'1.0-0' }}%</span>
        <button class="toolbar-btn" (click)="zoomIn()" [disabled]="zoom >= 3.0">
          <mat-icon>zoom_in</mat-icon>
        </button>
      </div>

      <!-- Actions -->
      <div class="toolbar-actions">
        <button class="toolbar-btn" (click)="triggerFileInput()" matTooltip="Upload new PDF">
          <mat-icon>upload_file</mat-icon>
        </button>
        <button class="toolbar-btn" (click)="downloadPdf()" *ngIf="selectedFile" matTooltip="Download PDF">
          <mat-icon>download</mat-icon>
        </button>
      </div>
    </div>
  </div>

  <!-- PDF Content -->
  <div class="pdf-content">
    <!-- Error Display -->
    <div class="error-state" *ngIf="error">
      <mat-icon>error_outline</mat-icon>
      <p>{{ error }}</p>
      <button class="retry-btn" (click)="triggerFileInput()">
        <mat-icon>refresh</mat-icon>
        Try Again
      </button>
    </div>

    <!-- Simple PDF Display -->
    <div class="simple-pdf-display" *ngIf="pdfSrc && !error">
      <iframe
        [src]="pdfBlobUrl"
        width="100%"
        height="600px"
        style="border: 1px solid #ccc;">
      </iframe>
    </div>

    <!-- Upload State -->
    <div class="upload-state" *ngIf="!pdfSrc && !error">
      <div class="upload-content">
        <div class="upload-icon">
          <mat-icon>cloud_upload</mat-icon>
        </div>
        <h3>No PDF loaded</h3>
        <p>Upload a PDF to start viewing and chatting</p>
        <button class="upload-btn" (click)="triggerFileInput()">
          <mat-icon>upload_file</mat-icon>
          Choose PDF File
        </button>
      </div>
    </div>
  </div>
</div>
